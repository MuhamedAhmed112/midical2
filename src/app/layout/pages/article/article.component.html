<div class="container mt-5">
  <h2>Articles</h2>

  <!-- Filtering and Sorting Controls -->
  <div class="row mb-4 gy-2 gx-3 align-items-center">
    <!-- Search -->
    <div class="col-sm-6 col-md-4 col-lg-3">
      <label for="searchTermInput" class="visually-hidden">Search</label>
      <input 
        type="text" 
        class="form-control" 
        id="searchTermInput" 
        placeholder="Search articles..." 
        [ngModel]="searchTerm" 
        (ngModelChange)="onSearchChange($event)">
    </div>
    <!-- Category -->
    <div class="col-sm-6 col-md-4 col-lg-3">
      <label for="categorySelect" class="visually-hidden">Category</label>
      <select class="form-select" id="categorySelect" [(ngModel)]="selectedCategory" (ngModelChange)="applyFilters()">
        <option [ngValue]="null">All Categories</option>
        <option *ngFor="let category of categories" [ngValue]="category.id">{{ category.name }}</option>
        <!-- TODO: Get actual category names if available -->
      </select>
    </div>
    <!-- Tag -->
    <div class="col-sm-6 col-md-4 col-lg-3">
        <label for="tagInput" class="visually-hidden">Tag</label>
        <input 
          type="text" 
          class="form-control" 
          id="tagInput" 
          placeholder="Filter by tag..." 
          [(ngModel)]="selectedTag" 
          (ngModelChange)="applyFilters()"> 
          <!-- Consider using debounce if tag input is frequent -->
      </div>
    <!-- Sort By -->
    <div class="col-sm-6 col-md-4 col-lg-2">
      <label for="sortBySelect" class="visually-hidden">Sort By</label>
      <select class="form-select" id="sortBySelect" [(ngModel)]="sortBy" (ngModelChange)="applyFilters()">
        <option *ngFor="let option of sortOptions" [value]="option.value">{{ option.label }}</option>
      </select>
    </div>
    <!-- Sort Direction -->
    <div class="col-auto">
      <div class="form-check">
        <input class="form-check-input" type="checkbox" id="sortDescendingCheck" [(ngModel)]="sortDescending" (ngModelChange)="applyFilters()" [disabled]="!sortBy">
        <label class="form-check-label" for="sortDescendingCheck">
          Descending
        </label>
      </div>
    </div>
  </div>

  <!-- Article List -->
  <div *ngIf="articles$ | async as articles; else loading">
    <div *ngIf="articles.length > 0; else noArticles">
      <div class="row">
        <div class="col-md-6 mb-4" *ngFor="let article of articles">
          <div class="card h-100">
            <img *ngIf="article.imageUrl" [src]="article.imageUrl" class="card-img-top article-image" alt="{{ article.title }}">
            <div class="card-body d-flex flex-column">
              <h5 class="card-title">{{ article.title }}</h5>
              <div *ngIf="article.tags && article.tags.length > 0" class="mb-2">
                <span *ngFor="let tag of article.tags" class="badge bg-secondary me-1">{{ tag }}</span>
              </div>
              <p class="card-text flex-grow-1">{{ article.content | slice:0:100 }}...</p> 
              <a [routerLink]="['/article', article.id]" class="btn btn-primary mt-auto">Read More</a>
            </div>
          </div>
        </div>
      </div>

      <!-- Pagination Controls -->
<nav aria-label="Article navigation" class="mt-4 d-flex justify-content-center">
  <ul class="pagination">
    <li class="page-item" [class.disabled]="currentPage === 1">
      <button class="page-link" (click)="previousPage()" [disabled]="currentPage === 1">Previous</button>
    </li>
    <!-- Display current page number -->
    <li class="page-item">
      <span class="page-link">Page {{ currentPage }}</span>
    </li>
    <li class="page-item" [class.disabled]="!hasMorePages">
      <button class="page-link" (click)="nextPage()" [disabled]="!hasMorePages">Next</button>
    </li>
  </ul>
</nav>


    </div>
    <ng-template #noArticles>
      <p>No articles found matching your criteria.</p>
    </ng-template>
  </div>
  <ng-template #loading>
    <p>Loading articles...</p>
  </ng-template>
</div>

